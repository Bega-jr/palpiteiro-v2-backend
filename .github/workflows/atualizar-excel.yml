 - name: Baixar Excel da Caixa (encontrando o link dinâmico)
        run: |
          PAGE_URL="https://loterias.caixa.gov.br/Paginas/Download-Resultados.aspx"
          echo "Baixando a página para encontrar o link do Excel..."
          
          # 1. Baixa o HTML da página para um arquivo temporário
          curl -L --fail -o pagina_download.html "$PAGE_URL"
          
          echo "Página baixada. Procurando pelo URL do arquivo Excel..."
          
          # 2. Extrai o URL do Excel usando grep e sed (procura por links que contenham 'D_Lotof')
          # Isso procura a linha que tem o link e extrai apenas o valor do atributo 'href'
          EXCEL_URL=$(grep -oP 'href="\K[^"]*D_Lotof[^"]*' pagina_download.html | head -n 1)
          
          if [ -z "$EXCEL_URL" ]; then
            echo "Erro: Não foi possível extrair o URL do arquivo Excel da página."
            exit 1
          fi
          
          # A URL extraída é relativa, precisamos adicionar o domínio completo da CAIXA
          FULL_URL="https://loterias.caixa.gov.br$EXCEL_URL"
          echo "URL do Excel encontrado: $FULL_URL"
          
          # 3. Baixa o arquivo Excel real
          echo "Iniciando download do Excel..."
          curl -L --fail -o Lotofácil.xlsx "$FULL_URL"
          
          echo "Download do Lotofácil.xlsx concluído com sucesso!"
